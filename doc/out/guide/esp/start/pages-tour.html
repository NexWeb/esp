<!DOCTYPE html>
<html lang="en">
<head>
    <title>ESP Pages Tour</title>
    <!-- Copyright Embedthis Software, LLC, 2003-2014. All Rights Reserved. -->
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="keywords" content="embedded web framework, C web framework, application web server" />
    <meta name="description" content="Embedthis Sofware provides web technologies for the Internet of Things." />
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Open+Sans:300italic,400,300,700'
        rel='stylesheet' type='text/css'>
    <link href="../../../lib/semantic/packaged/css/semantic.css" rel="stylesheet" type="text/css" />
    <link href="../../../css/all.css" rel="stylesheet" type="text/css" />
    <link href="../../../images/favicon.ico" rel="shortcut icon" />

</head>
<body>
        
    <div class="ui large left vertical inverted labeled overlay sidebar menu">
        <div class="item">
            <a href="../../../">
                <b>General</b>
            </a>
            <div class="menu">
                <a class="item" href="../../../index.html">ESP Overview</a>
                <a class="item" href="../../../guide/esp/features.html">ESP Features</a>
                <a class="item" href="../../../product/releaseNotes.html">Release Notes</a>
                <a class="item" href="https://github.com/embedthis/esp/releases">Change Log</a>
                <a class="item" href="https://github.com/embedthis/esp/milestones">Roadmap</a>
                <a class="item" href="https://embedthis.com/esp/download.html">Download</a> 
                <a class="item" href="../../../product/compatibility.html">Compatibility</a>
                <a class="item" href="../../../licenses/index.html">Licensing</a>
            </div>
        </div>
        <div class="item">
            <a href="../../../guide/esp/start/index.html">
                <b>Getting Started</b>
            </a>
            <div class="menu">
                <a class="item" href="../../../guide/esp/start/quick.html">Quick Start</a>
                <a class="item" href="../../../guide/esp/start/install/index.html">Installing ESP</a>
                <a class="item" href="../../../guide/esp/start/tour.html">ESP Tour</a>
                <a class="item" href="../../../guide/esp/start/pages-tour.html">ESP Pages Tour</a>
                <a class="item" href="../../../guide/esp/start/mvc-tour.html">ESP MVC Tour</a>
            </div>
        </div>
        <div class="item">
            <a href="../../../guide/esp/users/index.html"><b>Users Guide</b></a>
            <div class="menu">
                <a class="item" href="../../../guide/esp/overview.html">ESP Overview</a>
                <a class="item" href="../../../guide/esp/users/mvc.html">ESP MVC Framework</a>
                <a class="item" href="../../../guide/esp/users/config.html">Configuring ESP</a>
                <a class="item" href="../../../guide/esp/users/pages.html">ESP Pages and Layouts</a>
                <a class="item" href="../../../guide/esp/users/program.html">ESP Utility</a>
                <a class="item" href="../../../guide/esp/users/controllers.html">ESP Controllers</a>
                <a class="item" href="../../../guide/esp/users/database.html">ESP Databases</a>
                <a class="item" href="../../../guide/esp/users/sessions.html">ESP Sessions</a>
                <a class="item" href="../../../guide/esp/users/angular.html">ESP for Angular</a>
                <a class="item" href="../../../guide/esp/users/security.html">Security Considerations</a>
                <a class="item" href="../../../guide/esp/users/monitor.html">Monitoring and Defending</a>
                <a class="item" href="../../../guide/esp/users/hosting.html">Hosting in Appweb</a>
                <a class="item" href="../../../guide/esp/users/man.html">Manual Pages</a>
                <a class="item" href="../../../guide/esp/users/source.html">Building from Source</a>
            </div>
        </div>
        <div class="item">
            <a href="../../../ref/esp/index.html">Reference Guide</a>
            <div class="menu">
                <a class="item" href="../../../ref/esp/native.html">API Library</a>
                <a class="item" href="../../../ref/esp/memory.html">ESP Memory Allocation</a>
                <a class="item" href="../../../ref/esp/multithread.html">Multithreaded Programming</a>
            </div>
        </div>
        <div class="item">
            <a href="../../../product/project.html">Project Resources</a>
            <div class="menu">
                <a class="item" href="https://github.com/embedthis/esp">Source Code Repository</a>
                <a class="item" href="https://github.com/embedthis/esp/issues">Project Issue Database</a>
                <a class="item" href="https://embedthis.com/developers/contributors.html">Contributors Agreement</a>
            </div>
        </div>
        <div class="item">
            <b>Links</b>
            <div class="menu">
                <a class="item" href="http://goo.gl/dGRDl4">Official ESP News</a>
                <a class="item" href="http://groups.google.com/group/embedthis-esp">Community Support</a>
                <a class="item" href="https://embedthis.com/">Embedthis Web Site</a>
                <a class="item" href="https://embedthis.com/esp/">ESP Web Site</a>
                <a class="item" href="https://embedthis.com/blog/">Embedthis Blog</a>
                <a class="item" href="http://twitter.com/mobstream">Twitter</a>
            </div>
        </div>
    </div>

    <div class="ui inverted masthead">
                <div class="column">
            <div class="inverted secondary pointing ui menu">
                <div class="header left item">
                    <!-- <a href="/index.html"><img src="/images/embedthis.png"></a> -->
                    <a href="/index.html">ESP Documentation</a>
                </div>
                <div class="right menu">
                    <div class="ui top right">
                        <a class="item" href="https://embedthis.com/esp/">ESP</a>
                        <a class="item" href="https://github.com/embedthis/esp">Repository</a>
                        <a class="item" href="http://groups.google.com/group/embedthis-esp">Support</a>
                    </div>
                </div>
            </div>
            <div class="ui breadcrumb">
                <a class="section" href="../../../">Home</a>
                
                <div class="divider">/</div>
                <a class="section " href="index.html">
                    Getting Started
                </a>
                
                <div class="divider">/</div>
                <a class="section active" href="pages-tour.html">
                    ESP Pages Tour
                </a>
                
            </div>
        </div>
        <div class="ui black small launch right attached toggle button" style="width: 40px;">
            <i class="icon list layout">
                <span class="text" style="display: none;">Menu</span>
            </i>
        </div>

    </div>
    <div class="content">
<h1>ESP Pages Tour</h1>
            <p>This tour of ESP Pages provides an overview of how to create ESP Pages. 
            First make sure you have ESP installed on your system so you can type along as you go, and
            have read the quick tour <a href="tour.html">Quick Tour</a>.</p>
            
            <a id="run"></a>
            <h2 class="section">Running ESP</h2>
            <p>The first step is to create a directory for your ESP pages and run the <em>esp</em> utility to start
            listening for web requests from your browser.
            In this example, we create a directory called "<em>test</em>".</p>
<pre class="ui code segment"><b>mkdir test
cd test
esp</b>
esp: 2: Started HTTP service on "127.0.0.1:4000"
esp: 1: Started at Mon Apr 14 15:00:42 2014 PDT</pre>
            <p>ESP is now running and ready to serve documents from the "<em>test</em>" directory. ESP will display
            request errors and trace to the console.</p>
            <a id="hello"></a>
            <h2 class="section">Hello World</h2>
            <p>The first step is to create a dynamic "Hello World" web page. ESP pages have an <em>.esp</em>
            extension, so create a file called <em>hello.esp</em> in the <em>test</em> directory.
            Use your favorite text editor with the following content. </p>
            <pre class="ui code segment">
&lt;h1&gt;Hello Bright World&lt;/h1&gt;
&lt;h2&gt;Generated on <b>&lt;%= mprGetDate(0); %&gt;</b>&lt;/h2&gt;
</pre>
            <p>This code blends HTML with embedded "C" language code inside a special ESP web page 
            directive. This code will be executed and converted to HTML before being sent to the client. 
            There are a variety of ESP page directives, the one you'll use first, is: </p>
            <p><em>&lt;%= expression %&gt;</em>.</p>
            <p>Now when you re-run the page, it will display the current date and time. If you refresh the page by
            pressing reload, the new date and time will be displayed.</p>
            
            <img src="../../../images/esp/tour/hello-dynamic.png" alt="hello" class= "bare-screen" /> 
            <h4>No Restart Required</h4>
            <p>Notice that you did not have to restart the web server, nor did you have to manually recompile the
            ESP code. Rather, ESP transparently recompiled the web page in the background. ESP noticed that the hello.esp
            web page had been modified and it re-parsed and compiled it into a loadable module ready for execution. 
            This web module is then cached in-memory and on-disk for fast execution.</p>
            <p>You can also embed more complex ESP into our page, like:</p>
            <pre class="ui code segment">
<b>&lt;h3&gt;&lt;% render("Request method is %s", getMethod()); %&gt;&lt;/h3&gt;</b>
<b>&lt;% 
    int i;
    for (int i = 0; i &lt; 10; i++) {
        render(" Line: %d&lt;/br&gt;\r\n", i);
    } 
%&gt;</b>
</pre>
            <p>By using the ESP statement directive <b>&lt;% code %&gt;</b>, you can embed arbitrary "C" language
            statements in your web page. The <em>render</em> function allows you to write arbitrary data which is patched
            back where the directive was defined in the page. See the <a href="pages.html">Web Pages and Templates</a>
            document for full details about all the ESP web page directives.</p>
            
            <a id="declarations"></a>
            <h2 class="section">Declarations</h2>
            <p>Some compilers (Microsoft CL) do not permit "C" declarations except at the start of a block. When ESP
            compiles an ESP web page, it converts it to "C" code and wraps it inside a function that will be invoked
            at run-time in response to client requests. ESP supports MSCL by controlling where ESP code will be
            placed in the web page function. To ensure that declarations are emitted at the start of the function block 
            use the <em>^start</em> directive.</p>
<pre class="ui code segment">&lt;%^start
    char *msg = "hello world";
    int  x = 42;
%&gt;
&lt;%  render("%s, the answer is %d", msg, x); %&gt;
</pre>
            <a id="params"></a>
            <h2 class="section">Forms and Request Params</h2>
            <p>When an HTML form is submitted via a POST request, ESP converts form data and query parameters into 
            ESP request parameters. 
            These can be accessed via the <em>param()</em> function or more conveniently via the literal <em>&#64;&#64;variable</em> 
            directive. By prefixing a variable with <em>&#64;&#64;</em> ESP will automatically look up the request parameters,
            and if not found, the session data store for the variable, and then substitute its value.</p>
            <p>If an HTTP request has the URI: <em>http://localhost/submit.esp?name=julie</em>, then the following
            ESP code could access the user name directly.</p>
<pre class="ui code segment">&lt;p&gt;User Name: <b>&#64;&#64;name</b>&lt;/p&gt;</pre>
            <h3>XSS Security</h3>
            <p>Normally, echoing user input back to the client in a web page is bad practice and can invite XSS security
            attacks. Fortunately, ESP HTML escapes the &#64;&#64;variable value to prevent such attacks. </p>
            <p>General ESP output can also be escaped by using a "safe" "%S" format specifier. The renderSafe function
            can also be used.</p>
<pre class="ui code segment">&lt;p&gt;User Name: <b>&lt;%=%S param("name"); %&gt;</b>&lt;/p&gt;
&lt;p&gt;User Name: <b>&lt;%= renderSafe(param("name")); %&gt;</b>&lt;/p&gt;
</pre>
            <a id="sessions"></a>
            <h2>Sessions and Flash</h2>
            <p>ESP provides an integrated session store so that state can be shared across requests. Session variables
            can be accessed using the <em>&#64;&#64;variable</em> directive in ESP pages or via the
            <em>getSessionVar()</em> API.</p>
            <p>Flash storage is a portion of the session storage used to pass messages and state to the next request 
            controller only. This is useful after an error, to pass information to the next controller. 
            Messages can be added to flash storage via the <em>flash</em> API.</p>
<pre class="ui code segment">&lt;% <b>flash</b>("inform", Record updated"); %&gt;</pre>
            
            <a id="layouts"></a>
            <h2>Layouts</h2>
            <p>ESP Layouts provide a powerful and flexible solution for implementing a consistent UI. 
            ESP pages optionally use layout pages that define the look and feel of an application. Content pages are 
            then rendered by merging with one or more layout pages that define the look and feel of the 
            application to create a composite page that the user will actually see. In this way, a web 
            application can easily maintain a consistent look and feel without repeating boilerplate code 
            from page to page. </p>
            
            <p>A layout page provides template for the page and defines the location for the content via a
                <em>&lt;%@ content %&gt;</em> directive. For example, this is a simple ESP layout page:</p>
<pre class="ui code segment">
&lt;html&gt;
&lt;body&gt;
    &lt;div class="top"&gt;
        &lt;img src="banner.jpg" /&gt;
    &lt;/div&gt;
    &lt;div class="content"&gt;
        <b>&lt;%@ content %&gt;</b>
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
            <p>A content page defines only the HTML and code that is unique for a specific page. 
            It is merged with a layout page by inserting the content and replacing the <em>&lt;%@ content %&gt;</em> tag 
            in the layout page.</p>
            <p>To use a layout page, create a layout page called <em>default.esp</em> under the <em>client/layouts</em> 
            directory. Create the directory if it does not exist.</p>
            <p>ESP pages can specify a different layout page using the layout directive. For example:</p>
<pre class="ui code segment">
&lt;%@ layout "custom-layout.esp" %&gt;
&lt;h1&gt;Hello Bright World&lt;/h1&gt;
</pre>
            <a id="learn"></a>
            <h2 class="section">Learn More ...</h2>
            <p>That concludes a quick tour through some of the capabilities of the ESP web framework.</p>
            <p>To learn more, please read:</p>
            <ul>
                <li><a href="../users/mvc.html">ESP MVC Framework</a></li>
                <li><a href="mvc-tour.html">ESP MVC Tour</a>
            </ul>
            <p>You may also like to ask questions at the 
            <a href="http://groups.google.com/group/embedthis-esp/">ESP Support Forum</a>.</p>
    </div>
    <div class="ui basic center aligned segment" id="terms">
        <p>&copy; Embedthis Software, 2003-2014. All rights reserved.
            Generated on Aug 18, 2014.
        </p>
    </div>

    <script src="../../../lib/jquery/jquery.js"></script>
    <script src="../../../lib/semantic/packaged/javascript/semantic.js"></script>
    <script>
        $('.sidebar').sidebar({overlay: false}).sidebar('toggle');
        $('.sidebar').first().sidebar('attach events', '.toggle.button');
    </script>
</body>
</html>
